<!DOCTYPE html><html lang="kr"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Spring Profile 설정하기 | Devlog</title><link rel="stylesheet" href="/libs/spoqa-han-sans-kr/css/SpoqaHanSans-kr.css"><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/highlights/dracula.css"><link rel="canonical" href="http://yoursite.com/java/spring/spring-profile/"/>
<meta name="description" content="프로젝트를 설정할 때, real 서버에 업로드 했을때와 local에서 설정값을 다르게 주고 싶은 경우가 있습니다. 이때 매번 application.properties나 application.yml 파일을 수정해서 배포해주는 불편함을 겪었었는데…">
<meta name="keywords" content="Java,Spring">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring Profile 설정하기">
<meta property="og:url" content="http://yoursite.com/java/spring/spring-profile/">
<meta property="og:site_name" content="Devlog">
<meta property="og:description" content="프로젝트를 설정할 때, real 서버에 업로드 했을때와 local에서 설정값을 다르게 주고 싶은 경우가 있습니다. 이때 매번 application.properties나 application.yml 파일을 수정해서 배포해주는 불편함을 겪었었는데…">
<meta property="og:locale" content="kr">
<meta property="og:image" content="http://yoursite.com/images/java/spring/spring.jpg">
<meta property="og:updated_time" content="2018-06-10T10:27:27.111Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Spring Profile 설정하기">
<meta name="twitter:description" content="프로젝트를 설정할 때, real 서버에 업로드 했을때와 local에서 설정값을 다르게 주고 싶은 경우가 있습니다. 이때 매번 application.properties나 application.yml 파일을 수정해서 배포해주는 불편함을 겪었었는데…">
<meta name="twitter:image" content="http://yoursite.com/images/java/spring/spring.jpg"><meta property="article:author" content="https://www.facebook.com/xmfpes"><meta property="twitter:label1" content="Published at"><meta property="twitter:data1" content="2018-06-10 21:30:00"><meta property="twitter:label2" content="Written by"><meta property="twitter:data2" content="KyuNam"><link rel="icon" href="/images/internet.png"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Devlog"></head><body itemscope itemtype="https://schema.org/WebPage"><nav class="menu" id="menu"><div class="menu-inner"><div class="menu__left-area"><div class="menu__item"><a class="menu__item__link menu__item__link--brand" href="/" title="Home" rel="home"><img class="menu__item__link--brand__image" src="/images/internet.png" alt="Devlog"><span class="menu__item__link--brand__label">Devlog</span></a></div></div><div class="menu__right-area"><div class="menu__item"><a class="menu__item__link" href="/">Home</a></div><div class="menu__item"><a class="menu__item__link" href="/about">About</a></div><div class="menu__item"><a class="menu__item__link" href="/archives">Archives</a></div></div></div></nav><div class="page-background"></div><div class="content-container"><div class="content-outer"><div class="content-inner" itemscope itemtype="https://schema.org/Blog"><article class="article" id="article" itemscope itemtype="https://schema.org/BlogPosting"><h1 class="article__title" itemprop="headline">Spring Profile 설정하기</h1><div class="article__meta"><time class="article__meta__time" datetime="2018-06-10T12:30:00.000Z" itemprop="datePublished">2018-06-10 21:30:00</time><div class="article__meta__categories"><a class="article__meta__categories__item" href="/categories/Backend/">Backend</a><span class="article__meta__categories__separator">></span><a class="article__meta__categories__item" href="/categories/Backend/Java/">Java</a><span class="article__meta__categories__separator">></span><a class="article__meta__categories__item" href="/categories/Backend/Java/Spring/">Spring</a></div></div><div class="article__contents"><img src="/images/java/spring/spring.jpg"/><p>프로젝트를 설정할 때, real 서버에 업로드 했을때와 local에서 설정값을 다르게 주고 싶은 경우가 있습니다.</p>
<p>이때 매번 application.properties나 application.yml 파일을 수정해서 배포해주는 불편함을 겪었었는데 spring profile 옵션을 추가해서 <strong>현재 프로젝트의 active 값에 따라 다른 설정을 로드</strong>할 수 있습니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  profiles:</span><br><span class="line">    active: local # 기본 환경 선택 # local 환경</span><br></pre></td></tr></table></figure>
<p>위는 로컬 환경에서의 설정이고, 배포해서 나가는 real에서는 값을 real로 주거나 해서 real에 맞는 설정값을 받아올 수 있습니다.</p>
<p>그리고 <code>real-applcation.yml</code> 파일을 따로 만들어 로드하게 해서 real 환경에서의 db 설정 아이디, 비밀번호 등 여러 값을 숨기는 데도 활용할 수 있습니다.</p>
<p>저는 이번에 local과 real을 구분해, local에서 h2 환경, real에서는 rds 환경을 이용하도록, 그리고 rds 데이터베이스 설정을 프로젝트에서 숨길 수 있도록 spring profile을 설정하겠습니다.</p>
<h3 id="Spring-Profile-설정하기"><a href="#Spring-Profile-설정하기" class="headerlink" title="Spring Profile 설정하기"></a>Spring Profile 설정하기</h3><p>기본적으로 아래처럼, 현재의 active 환경을 지정해 줄 수 있습니다. 현재는 local로 지정된 상태입니다.</p>
<p>그리고 가운데에 local 환경에서의 기본 h2 설정을 셋팅하고,  아래에는 하이픈(<code>---</code>)으로 구분된 real 서버의 셋팅을 줬습니다.</p>
<p>application.yml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  profiles:</span><br><span class="line">    active: local # 기본 환경 선택 # local 환경</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">spring:</span><br><span class="line">  profiles: local</span><br><span class="line">  # datasource:</span><br><span class="line">  #  data: classpath:data-h2.sql # 시작할때 실행시킬 script</span><br><span class="line">  jpa:</span><br><span class="line">    show-sql: true</span><br><span class="line">    hibernate:</span><br><span class="line">      ddl-auto: create-drop</span><br><span class="line">  h2:</span><br><span class="line">    console:</span><br><span class="line">      enabled: true</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">spring.profiles: real</span><br><span class="line">spring.profiles.include: real-db</span><br><span class="line">server:</span><br><span class="line">  port: 8081</span><br></pre></td></tr></table></figure>
<p>위의 설정에서는 <code>spring.profiles.active: local</code> 일 때 local 환경의 profile을 적용하고, <code>spring.profiles.active: real</code>인 경우 real 환경의 profile을 적용합니다.</p>
<p>아래 real 환경에서 <code>spring.profiles.include</code> 은 해당 real profile을 사용 할 때, real-db라는 profile을 포함시켜준다는 내용입니다. 지금은 db 설정만 있지만 추가적으로 다른 설정이 들어간다면 include를 늘려서 추가할 수 있습니다.</p>
<h3 id="외부-경로에-존재하는-Spring-profile-로드하기"><a href="#외부-경로에-존재하는-Spring-profile-로드하기" class="headerlink" title="외부 경로에 존재하는 Spring profile 로드하기"></a>외부 경로에 존재하는 Spring profile 로드하기</h3><p>그럼 이제 real-db 설정을 다른 사람들이 볼 수 없도록, 내 Git 프로젝트에 포함시키지 않고 서버나 내 로컬 환경의 어딘가 경로에 저장을 해 둡니다. 우선 <code>real-application.yml</code> 파일을 하나 생성하겠습니다.</p>
<p>real-application.yml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">spring:</span><br><span class="line">  profiles: real-db</span><br><span class="line">  datasource:</span><br><span class="line">    url: jdbc:mariadb://your-maridadb-url/dbName</span><br><span class="line">    username: yourUserName</span><br><span class="line">    password: yourPassWord</span><br><span class="line">    driver-class-name: org.mariadb.jdbc.Driver</span><br></pre></td></tr></table></figure>
<p>위의 파일을 작성한 다음에, 아무 경로에나 둡니다. 저는 그냥 간단하게 <code>/Users/kyunam/Documents/spring-config/real-application.yml</code> 경로에 작성했습니다.</p>
<p>그리고 이 외부의 파일을 호출할 수 있도록 프로젝트의 Application.java 코드에 profile 경로와 profile을 추가하는 코드를 작성합니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.todo.springbootangulartodo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.builder.SpringApplicationBuilder;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootAngularTodoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String APPLICATION_LOCATIONS = <span class="string">"spring.config.location="</span> + <span class="string">"classpath:application.yml,"</span></span><br><span class="line">            + <span class="string">"/Users/kyunam/Documents/spring-config/real-application.yml"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> SpringApplicationBuilder(SpringBootAngularTodoApplication.class)</span><br><span class="line">                .properties(APPLICATION_LOCATIONS)</span><br><span class="line">                .run(args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>위처럼 기존의 application.yml을 추가하고, 외부 경로에 있는 real-application.yml을 로드한 후 아래의 main에서 properties를 통해 등록합니다.</p>
<p>정상적으로 등록이 됐으면, <code>application.yml</code>의 윗부분을 아래와 같이 real로 변경하고 서버를 빌드, 배포 해봅니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  profiles:</span><br><span class="line">    active: real</span><br></pre></td></tr></table></figure>
<p>정상적으로 완료가 됐으면, 위의 설정대로 8081포트에서, maria db rds 설정을 따르도록 바라보는것을 알 수 있습니다.</p>
<p>위를 응용해 redis나, 다른 세션 db를 설정해주거나 logging 설정을 다르게 주거나 할 수 있습니다. 그리고 물론 외부에도 노출이 되지 않겠죠</p>
<p>출처: <a href="http://jojoldu.tistory.com/255?category=635883" target="_blank" rel="noopener">http://jojoldu.tistory.com/255?category=635883</a> [기억보단 기록을]</p>
</div><div class="article__tags"><a class="article__tags__item" href="/tags/Java/">Java</a><a class="article__tags__item" href="/tags/Spring/">Spring</a></div><div class="article__author" itemscope itemprop="author" itemtype="https://schema.org/Person"><img class="article__author__image" src="/images/profile.png" alt="KyuNam"><a class="article__author__link" title="About KyuNam" rel="author">KyuNam</a><p class="article__author__desc">dev log</p><div class="article__author__socials"><a class="article__author__socials__item" href="https://github.com/tramyu" title="github" target="_blank"><i class="fa fa-github"></i></a><a class="article__author__socials__item" href="https://www.facebook.com/xmfpes" title="facebook" target="_blank"><i class="fa fa-facebook"></i></a><a class="article__author__socials__item" href="https://www.linkedin.com/feed/" title="linkedin" target="_blank"><i class="fa fa-linkedin"></i></a><a class="article__author__socials__item" href="https://www.instagram.com/" title="instagram" target="_blank"><i class="fa fa-instagram"></i></a><a class="article__author__socials__item" href="/atom.xml" title="rss" target="_blank"><i class="fa fa-rss"></i></a></div><meta itemprop="name" content="KyuNam"></div><div class="sharer" id="sharer"><div class="sharer-inner"><div class="sharer__right"><button class="sharer__item" id="sharer-facebook"><i class="fa fa-facebook-official"></i></button><button class="sharer__item" id="sharer-twitter"><i class="fa fa-twitter"></i></button><button class="sharer__item" id="sharer-pinterest"><i class="fa fa-pinterest"></i></button><button class="sharer__item" id="sharer-pocket"><i class="fa fa-get-pocket"></i></button></div></div></div><!-- Disqus Code--><div id="disqus_thread"></div><script>(function() {
  var d = document, s = d.createElement('script');
  s.src = '//kyunam-disqus-com.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Enable JavaScript to see comments.</noscript><!-- Meta Tags for Structured Data--><meta itemprop="dateModified" content="2018-06-10T10:27:27.111Z"><meta itemprop="articleBody" content="프로젝트를 설정할 때, real 서버에 업로드 했을때와 local에서 설정값을 다르게 주고 싶은 경우가 있습니다.
이때 매번 application.properties나 application.yml 파일을 수정해서 배포해주는 불편함을 겪었었는데 spring profile 옵션을 추가해서 현재 프로젝트의 active 값에 따라 다른 설정을 로드할 수..."><meta itemprop="url" content="http://yoursite.com/java/spring/spring-profile/"><meta itemprop="mainEntityOfPage" content="http://yoursite.com/java/spring/spring-profile/"><div itemscope itemtype="https://schema.org/Organization" itemprop="publisher"><meta itemprop="name" content="Devlog"><div itemscope itemprop="logo" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="http://yoursite.com/images/internet.png"></div></div><div itemscope itemtype="https://schema.org/ImageObject" itemprop="image"><meta itemprop="contentUrl" content="http://yoursite.com/images/java/spring/spring.jpg"><meta itemprop="url" content="http://yoursite.com/images/java/spring/spring.jpg"><meta itemprop="width" content="1280"><meta itemprop="height" content="720"></div></article><section class="related-posts"><h3>Related posts</h3><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/java/spring/spring-security/"><div class="related-posts__item__background" style="background-image:url('/images/java/spring/spring.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">Spring Security의 간략한 구조</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/java/spring/spring-boot-angular-01/"><div class="related-posts__item__background" style="background-image:url('/images/java/spring/spring.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">스프링 부트와 Angular로 게시판 만들기 - 1. 프로젝트 생성하기</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/java/spring/spring-boot-angular-02/"><div class="related-posts__item__background" style="background-image:url('/images/java/spring/spring.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">스프링 부트와 Angular로 게시판 만들기 - 2. Angular 프로젝트 초기 설정하기</span></a></div></section></div></div></div><footer id="footer"><div class="widgets"><div class="widgets-inner"><!-- Jade doesn't support dynamic inclusion with `each`.--><!-- So, I just hard coded the file names that will be included.--><div class="widgets__item"><h3 class="widgets__item__heading">Recent posts</h3><ul class="recent-posts"><li class="recent-posts__item"><a href="/java/spring/spring-boot/"></a></li><li class="recent-posts__item"><a href="/etc/spring-deploy-ec2/">Spring Boot 프로젝트 EC2에 배포하기</a></li><li class="recent-posts__item"><a href="/etc/aws setting/">AWS EC2 생성 및 RDS 구축하기</a></li><li class="recent-posts__item"><a href="/java/spring/spring-profile/">Spring Profile 설정하기</a></li><li class="recent-posts__item"><a href="/etc/interview/">서버 개발자 면접 질문 정리</a></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Categories</h3><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Backend/">Backend</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Backend/Java/">Java</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Backend/Java/DesignPattern/">DesignPattern</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Backend/Java/Spring/">Spring</a><span class="category-list-count">5</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Blog/">Blog</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Blog/Hexo/">Hexo</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CS/">CS</a><span class="category-list-count">21</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CS/Algorithm/">Algorithm</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CS/Datastructure/">Datastructure</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Frontend/">Frontend</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Frontend/Javascript/">Javascript</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Interview/">Interview</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Issue/">Issue</a><span class="category-list-count">1</span></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Tag cloud</h3><div class="tag-cloud"><a href="/tags/AbstractFactory/" style="font-size: 0.9rem;">AbstractFactory</a> <a href="/tags/Algorithm/" style="font-size: 1.5rem;">Algorithm</a> <a href="/tags/Graph/" style="font-size: 0.75rem;">Graph</a> <a href="/tags/Hexo/" style="font-size: 0.75rem;">Hexo</a> <a href="/tags/Interview/" style="font-size: 1.05rem;">Interview</a> <a href="/tags/Java/" style="font-size: 1.35rem;">Java</a> <a href="/tags/Javascript/" style="font-size: 0.9rem;">Javascript</a> <a href="/tags/Mybatis/" style="font-size: 0.75rem;">Mybatis</a> <a href="/tags/Spring/" style="font-size: 1.2rem;">Spring</a></div></div></div></div><p class="copyright"><small>© 2018 KyuNam<br>Powered by <a href="https://hexo.io" rel="external" target="_blank">Hexo</a>, Theme by <a href="https://github.com/hyunseob" rel="external" target="_blank">HyunSeob</a></small></p></footer><script src="/js/sharer.min.js"></script></body></html>