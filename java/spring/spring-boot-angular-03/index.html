<!DOCTYPE html><html lang="kr"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>스프링 부트와 Angular로 게시판 만들기 - 3. 로그인 | Devlog</title><link rel="stylesheet" href="/libs/spoqa-han-sans-kr/css/SpoqaHanSans-kr.css"><link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/highlights/dracula.css"><link rel="canonical" href="http://yoursite.com/java/spring/spring-boot-angular-03/"/>
<meta name="description" content="Jwt 토큰 인증 기반 시스템 플로우 리퀘스트가 들어오고 스프링(servletfilterChain)을 통해 필터로 걸러진다. 이제 인증 필터를 만들어서 필터 체인에 등록하고 요청에 대한 인증처리를 함. ProviderManager에서 검색된…">
<meta name="keywords" content="Java,Spring">
<meta property="og:type" content="article">
<meta property="og:title" content="스프링 부트와 Angular로 게시판 만들기 - 3. 로그인">
<meta property="og:url" content="http://yoursite.com/java/spring/spring-boot-angular-03/">
<meta property="og:site_name" content="Devlog">
<meta property="og:description" content="Jwt 토큰 인증 기반 시스템 플로우 리퀘스트가 들어오고 스프링(servletfilterChain)을 통해 필터로 걸러진다. 이제 인증 필터를 만들어서 필터 체인에 등록하고 요청에 대한 인증처리를 함. ProviderManager에서 검색된…">
<meta property="og:locale" content="kr">
<meta property="og:image" content="http://yoursite.com/images/java/spring/spring.jpg">
<meta property="og:updated_time" content="2018-05-13T14:45:02.150Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="스프링 부트와 Angular로 게시판 만들기 - 3. 로그인">
<meta name="twitter:description" content="Jwt 토큰 인증 기반 시스템 플로우 리퀘스트가 들어오고 스프링(servletfilterChain)을 통해 필터로 걸러진다. 이제 인증 필터를 만들어서 필터 체인에 등록하고 요청에 대한 인증처리를 함. ProviderManager에서 검색된…">
<meta name="twitter:image" content="http://yoursite.com/images/java/spring/spring.jpg"><meta property="article:author" content="https://www.facebook.com/xmfpes"><meta property="twitter:label1" content="Published at"><meta property="twitter:data1" content="2018-05-10 21:30:00"><meta property="twitter:label2" content="Written by"><meta property="twitter:data2" content="KyuNam"><link rel="icon" href="/images/internet.png"><link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Devlog"></head><body itemscope itemtype="https://schema.org/WebPage"><nav class="menu" id="menu"><div class="menu-inner"><div class="menu__left-area"><div class="menu__item"><a class="menu__item__link menu__item__link--brand" href="/" title="Home" rel="home"><img class="menu__item__link--brand__image" src="/images/internet.png" alt="Devlog"><span class="menu__item__link--brand__label">Devlog</span></a></div></div><div class="menu__right-area"><div class="menu__item"><a class="menu__item__link" href="/">Home</a></div><div class="menu__item"><a class="menu__item__link" href="/about">About</a></div><div class="menu__item"><a class="menu__item__link" href="/archives">Archives</a></div></div></div></nav><div class="page-background"></div><div class="content-container"><div class="content-outer"><div class="content-inner" itemscope itemtype="https://schema.org/Blog"><article class="article" id="article" itemscope itemtype="https://schema.org/BlogPosting"><h1 class="article__title" itemprop="headline">스프링 부트와 Angular로 게시판 만들기 - 3. 로그인</h1><div class="article__meta"><time class="article__meta__time" datetime="2018-05-10T12:30:00.000Z" itemprop="datePublished">2018-05-10 21:30:00</time><div class="article__meta__categories"><a class="article__meta__categories__item" href="/categories/Backend/">Backend</a><span class="article__meta__categories__separator">></span><a class="article__meta__categories__item" href="/categories/Backend/Java/">Java</a><span class="article__meta__categories__separator">></span><a class="article__meta__categories__item" href="/categories/Backend/Java/Spring/">Spring</a></div></div><div class="article__contents"><img src="/images/java/spring/spring.jpg"/><p>Jwt 토큰 인증 기반 시스템 플로우</p>
<p>리퀘스트가 들어오고</p>
<p>스프링(servletfilterChain)을 통해 필터로 걸러진다.</p>
<p>이제 인증 필터를 만들어서 필터 체인에 등록하고 요청에 대한 인증처리를 함.</p>
<p>ProviderManager에서 검색된 프로바이더에서 인증 객체 처리 .authenticate()</p>
<p>그리고 인증된 객체 반환</p>
<p>Spring 기준</p>
<p>구현해야 할 목록들</p>
<ul>
<li>요청을 받을 필터(AbstractAthunticationFilter)</li>
</ul>
<p>폼로그인 필터, 소셜 로그인 필터..(공급자 통합)</p>
<ul>
<li>Manager에 등록할 Auth Provider</li>
</ul>
<ul>
<li>인증 정보를 담을 Dto</li>
<li>인증에 따른 추가 구현체, 성공 실패 핸들러</li>
<li>소셜 로그인의 경우 소셜 공급자의 규격에 맞는 dto, HttpRequest 객체(RestTemplate)</li>
<li>인증 시도 / 인증 성공 시 반환할 Authentication 객체</li>
</ul>
<p>Implicit grant flow</p>
<p>프론트에서 인증, 인증 결과물을 서버로 보내서 토큰을 발급 받는다.</p>
<p>파이어베이스에 로그인, 파이어베이스에서 토큰 받고 벡엔드에 요청 벡엔드에서 파이어베이스 토큰을 내려받아 인증여부 확인 후 응답</p>
<h2 id="유저-객체-설계"><a href="#유저-객체-설계" class="headerlink" title="유저 객체 설계"></a>유저 객체 설계</h2><p>유저 account 객체 설계</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tram.springbootangularboard.domain</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.tram.springbootangularboard.<span class="keyword">enum</span>.UserRole</span><br><span class="line"><span class="keyword">import</span> javax.persistence.*</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = <span class="meta-string">"account"</span>)</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span></span>(</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Id</span></span><br><span class="line">        <span class="meta">@GeneratedValue(strategy = GenerationType.AUTO)</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> id: <span class="built_in">Long</span>? = <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Column(name = <span class="meta-string">"account_username"</span>)</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> username: String? = <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Column(name = <span class="meta-string">"account_user_id"</span>)</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> userId: String? = <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Column(name = <span class="meta-string">"account_password"</span>)</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> password: String? = <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Column(name = <span class="meta-string">"account_role"</span>)</span></span><br><span class="line">        <span class="meta">@Enumerated(value = EnumType.STRING)</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> userRole: UserRole? = <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Column(name = <span class="meta-string">"account_social_id"</span>)</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> socialId: <span class="built_in">Long</span>? = <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Column(name = <span class="meta-string">"account_profile_thumb_url"</span>)</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> profileThumbUrl: String? = <span class="literal">null</span>)</span><br></pre></td></tr></table></figure>
<p>internal은 자바의 접근지정자. 같은 모듈에서만 ..</p>
<p>kotlin에서 data를 적어주면 lombok의 @Data처럼 getter, setter, toString을 구현해준다. 그리고 괄호 안에있는 필드를 선언함과 동시에 생성자 생성.</p>
<p>companion은 java의 static의 역할을 한다.</p>
<p>JPA에서 enum을 매핑할 때 기본값은 @Enumerated(value = EnumType.ORDINAL) enum을 스트링으로 디비에서 관리하지 않고 ADMIN(1번), USER(2번) 이런식으로 숫자 order값으로 저장되게 되므로 <code>@Enumerated(value = EnumType.STRING)</code> 값을 주자.</p>
</div><div class="article__tags"><a class="article__tags__item" href="/tags/Java/">Java</a><a class="article__tags__item" href="/tags/Spring/">Spring</a></div><div class="article__author" itemscope itemprop="author" itemtype="https://schema.org/Person"><img class="article__author__image" src="/images/profile.png" alt="KyuNam"><a class="article__author__link" title="About KyuNam" rel="author">KyuNam</a><p class="article__author__desc">dev log</p><div class="article__author__socials"><a class="article__author__socials__item" href="https://github.com/tramyu" title="github" target="_blank"><i class="fa fa-github"></i></a><a class="article__author__socials__item" href="https://www.facebook.com/xmfpes" title="facebook" target="_blank"><i class="fa fa-facebook"></i></a><a class="article__author__socials__item" href="https://www.linkedin.com/feed/" title="linkedin" target="_blank"><i class="fa fa-linkedin"></i></a><a class="article__author__socials__item" href="https://www.instagram.com/" title="instagram" target="_blank"><i class="fa fa-instagram"></i></a><a class="article__author__socials__item" href="/atom.xml" title="rss" target="_blank"><i class="fa fa-rss"></i></a></div><meta itemprop="name" content="KyuNam"></div><div class="sharer" id="sharer"><div class="sharer-inner"><div class="sharer__right"><button class="sharer__item" id="sharer-facebook"><i class="fa fa-facebook-official"></i></button><button class="sharer__item" id="sharer-twitter"><i class="fa fa-twitter"></i></button><button class="sharer__item" id="sharer-pinterest"><i class="fa fa-pinterest"></i></button><button class="sharer__item" id="sharer-pocket"><i class="fa fa-get-pocket"></i></button></div></div></div><!-- Disqus Code--><div id="disqus_thread"></div><script>(function() {
  var d = document, s = d.createElement('script');
  s.src = '//kyunam-disqus-com.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Enable JavaScript to see comments.</noscript><!-- Meta Tags for Structured Data--><meta itemprop="dateModified" content="2018-05-13T14:45:02.150Z"><meta itemprop="articleBody" content="Jwt 토큰 인증 기반 시스템 플로우
리퀘스트가 들어오고
스프링(servletfilterChain)을 통해 필터로 걸러진다.
이제 인증 필터를 만들어서 필터 체인에 등록하고 요청에 대한 인증처리를 함.
ProviderManager에서 검색된 프로바이더에서 인증 객체 처리 .authenticate()
그리고 인증된 객체 반환
Spring 기준
구현해야..."><meta itemprop="url" content="http://yoursite.com/java/spring/spring-boot-angular-03/"><meta itemprop="mainEntityOfPage" content="http://yoursite.com/java/spring/spring-boot-angular-03/"><div itemscope itemtype="https://schema.org/Organization" itemprop="publisher"><meta itemprop="name" content="Devlog"><div itemscope itemprop="logo" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="http://yoursite.com/images/internet.png"></div></div><div itemscope itemtype="https://schema.org/ImageObject" itemprop="image"><meta itemprop="contentUrl" content="http://yoursite.com/images/java/spring/spring.jpg"><meta itemprop="url" content="http://yoursite.com/images/java/spring/spring.jpg"><meta itemprop="width" content="1280"><meta itemprop="height" content="720"></div></article><section class="related-posts"><h3>Related posts</h3><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/java/spring/spring-security/"><div class="related-posts__item__background" style="background-image:url('/images/java/spring/spring.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">Spring Security의 간략한 구조</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/java/spring/spring-boot-angular-01/"><div class="related-posts__item__background" style="background-image:url('/images/java/spring/spring.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">스프링 부트와 Angular로 게시판 만들기 - 1. 프로젝트 생성하기</span></a></div><div class="related-posts__item__wrapper"><a class="related-posts__item" href="/java/spring/spring-boot-angular-02/"><div class="related-posts__item__background" style="background-image:url('/images/java/spring/spring.jpg');"></div><div class="related-posts__item__overlay"></div><span class="related-posts__item__title">스프링 부트와 Angular로 게시판 만들기 - 2. Angular 프로젝트 초기 설정하기</span></a></div></section></div></div></div><footer id="footer"><div class="widgets"><div class="widgets-inner"><!-- Jade doesn't support dynamic inclusion with `each`.--><!-- So, I just hard coded the file names that will be included.--><div class="widgets__item"><h3 class="widgets__item__heading">Recent posts</h3><ul class="recent-posts"><li class="recent-posts__item"><a href="/java/spring/spring-security/">Spring Security의 간략한 구조</a></li><li class="recent-posts__item"><a href="/algorithm/algorithm-20/">Codility 5-2 PassingCars</a></li><li class="recent-posts__item"><a href="/java/spring/spring-boot-angular-03/">스프링 부트와 Angular로 게시판 만들기 - 3. 로그인</a></li><li class="recent-posts__item"><a href="/java/spring/spring-boot-angular-02/">스프링 부트와 Angular로 게시판 만들기 - 2. Angular 프로젝트 초기 설정하기</a></li><li class="recent-posts__item"><a href="/java/spring/spring-boot-angular-01/">스프링 부트와 Angular로 게시판 만들기 - 1. 프로젝트 생성하기</a></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Categories</h3><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Backend/">Backend</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Backend/Java/">Java</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Backend/Java/DesignPattern/">DesignPattern</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Backend/Java/Spring/">Spring</a><span class="category-list-count">4</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Blog/">Blog</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Blog/Hexo/">Hexo</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CS/">CS</a><span class="category-list-count">21</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CS/Algorithm/">Algorithm</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CS/Datastructure/">Datastructure</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Frontend/">Frontend</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Frontend/Javascript/">Javascript</a><span class="category-list-count">2</span></li></ul></li></ul></div><div class="widgets__item"><h3 class="widgets__item__heading">Tag cloud</h3><div class="tag-cloud"><a href="/tags/AbstractFactory/" style="font-size: 0.94rem;">AbstractFactory</a> <a href="/tags/Algorithm/" style="font-size: 1.5rem;">Algorithm</a> <a href="/tags/Graph/" style="font-size: 0.75rem;">Graph</a> <a href="/tags/Hexo/" style="font-size: 0.75rem;">Hexo</a> <a href="/tags/Java/" style="font-size: 1.31rem;">Java</a> <a href="/tags/Javascript/" style="font-size: 0.94rem;">Javascript</a> <a href="/tags/Spring/" style="font-size: 1.13rem;">Spring</a></div></div></div></div><p class="copyright"><small>© 2018 KyuNam<br>Powered by <a href="https://hexo.io" rel="external" target="_blank">Hexo</a>, Theme by <a href="https://github.com/hyunseob" rel="external" target="_blank">HyunSeob</a></small></p></footer><script src="/js/sharer.min.js"></script></body></html>